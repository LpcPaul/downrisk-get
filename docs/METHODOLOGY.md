# 方法论详解

本文档详细说明 downrisk-get 项目的核心方法论、计算公式和设计理念。

---

## 📖 目录

1. [核心理念](#核心理念)
2. [Scheme C 风险模型](#scheme-c-风险模型)
3. [关键指标计算](#关键指标计算)
4. [期望收益框架](#期望收益框架)
5. [行业ETF代理](#行业etf代理)
6. [参数校准指南](#参数校准指南)
7. [模型验证](#模型验证)

---

## 核心理念

### 为什么不用个股历史数据？

传统的风险评估方法依赖个股历史数据，但存在以下问题：

#### 问题1: 样本偏差
- **基本面变化**：公司可能经历重大转型（如业务重组、管理层更换）
- **历史不代表未来**：过去的波动模式可能不适用于未来
- **例子**：一家从制造业转型为科技公司的企业，历史数据完全失效

#### 问题2: 幸存者偏差
- **只看到活下来的**：退市、破产的公司不在样本中
- **高估安全性**：历史数据低估了真实的尾部风险
- **例子**：2000年互联网泡沫后，大量公司消失

#### 问题3: 小样本问题
- **新标的**：IPO不久的公司缺乏足够历史数据
- **转型公司**：业务模式变化后，旧数据无参考价值
- **数据不足**：统计显著性不足，结果不可靠

#### 问题4: 极端事件
- **一次性冲击**：如财务造假、监管处罚
- **扭曲风险估计**：单一事件导致波动率虚高
- **不可复制**：极端事件通常不会重复发生

### 本项目的解决方案

#### 1. 使用行业ETF作为风险代理

**优势**：
- ✅ **更稳定**：ETF包含多家公司，平滑个股特殊性
- ✅ **更具代表性**：反映行业整体风险特征
- ✅ **适用新标的**：即使公司刚上市，行业风险仍可评估
- ✅ **避免极端事件**：个股黑天鹅不影响行业整体

**假设**：
- 个股的风险主要来自行业系统性风险
- 通过β系数和脆弱度调整，可以捕捉个股特殊性

#### 2. 真实下行波动率

**为什么不用总波动率？**
- 投资者更关心下跌风险，而非上涨波动
- 上涨和下跌的分布不对称（下跌更集中）
- 下行波动率更准确衡量"损失风险"

**为什么不用σ/√2近似？**
- 真实下行波动率 ≠ 总波动率 / √2
- 基于实际数据计算更准确
- 日频半方差年化是标准方法

#### 3. Scheme C三因子模型

**设计原理**：
```
损失风险 = 下行风险（60%） + 系统性风险（30%） + 结构性风险（10%）
```

- **60%下行风险**：最重要，直接反映下跌损失
- **30%系统性风险**：β × 总波动，反映与行业共振程度
- **10%结构性风险**：脆弱度，反映公司特有风险

**权重设计逻辑**：
- 下行风险占主导（60%）
- 系统性风险作为重要补充（30%）
- 结构性风险作为微调（10%）

---

## Scheme C 风险模型

### 完整公式

```
LossRisk = w_down × σ_down + w_beta × (β × σ_total) + w_frag × Frag

默认权重：
- w_down = 0.6
- w_beta = 0.3
- w_frag = 0.1
```

### 第一项：下行风险（60%权重）

#### 定义
只考虑低于MAR（最低可接受收益，默认0）的波动。

#### 计算步骤

**步骤1：计算日收益率**
```
r_t = (P_t - P_{t-1}) / P_{t-1}
```

**步骤2：提取下行收益**
```
r_down_t = min(r_t - MAR, 0)
```
- 只保留负收益
- MAR默认为0（即只要下跌就计入）

**步骤3：计算半方差**
```
semi_variance = (1/N) × Σ(r_down_t)²
```
- N是样本数（天数）
- 只对下行收益求平方和

**步骤4：年化**
```
σ_down = sqrt(semi_variance) × sqrt(252)
```
- 252是一年交易日数
- √252用于日频到年频转换

#### 代码实现
```python
def downside_volatility(returns, mar=0.0, annualize=True, td_per_year=252):
    """
    计算下行波动率

    参数：
    - returns: 日收益率序列
    - mar: 最低可接受收益（默认0）
    - annualize: 是否年化（默认True）
    - td_per_year: 每年交易日数（默认252）

    返回：
    - 下行波动率（年化）
    """
    # 1. 只保留负偏差
    downside = np.minimum(returns - mar, 0.0)

    # 2. 计算半方差
    semi_variance = np.mean(downside ** 2)

    # 3. 开方得到下行标准差
    semi_std = np.sqrt(semi_variance)

    # 4. 年化（如果需要）
    if annualize:
        semi_std = semi_std * np.sqrt(td_per_year)

    return semi_std
```

### 第二项：系统性风险（30%权重）

#### 定义
β × σ_total，反映个股相对行业的敏感度。

#### β系数的含义

**β = 1.0**：与行业同步
- 行业上涨10%，个股也上涨10%
- 行业下跌10%，个股也下跌10%
- 适用于行业平均水平的公司

**β > 1.0**：比行业波动更剧烈
- 周期股：β = 1.2-1.5（如有色金属、半导体）
- 杠杆股：财务杠杆高的公司
- 成长股：高增长高波动

**β < 1.0**：比行业波动更平稳
- 防御股：β = 0.7-0.9（如公用事业）
- 龙头股：市场地位稳固
- 混合配置：如紫金矿业β=0.95

#### β系数计算方法

**方法1：OLS回归（默认）**
```python
def beta_ols(stock_returns, sector_returns, min_overlap=50):
    """
    OLS回归计算β系数

    模型：stock_return = α + β × sector_return + ε

    β = Cov(stock, sector) / Var(sector)
    """
    # 1. 对齐时间序列
    aligned = pd.concat([stock_returns, sector_returns], axis=1).dropna()

    # 2. 检查样本数
    if len(aligned) < min_overlap:
        return 1.0  # 样本不足，返回默认β

    # 3. 提取数据
    stock = aligned.iloc[:, 0].values
    sector = aligned.iloc[:, 1].values

    # 4. 计算协方差矩阵
    cov_matrix = np.cov(stock, sector)
    var_sector = cov_matrix[1, 1]  # Var(sector)
    cov_stock_sector = cov_matrix[0, 1]  # Cov(stock, sector)

    # 5. β = Cov / Var
    beta = cov_stock_sector / var_sector

    return beta
```

**方法2：Huber鲁棒回归（可选）**
- 对异常值更稳健
- 适合数据中有极端值的情况
- 使用sklearn.linear_model.HuberRegressor

**手工设定（推荐）**
- 基于行业经验和公司特性
- 参考行业平均β
- 根据公司杠杆、周期性等调整

#### β系数参考值

| 行业类型 | 推荐β | 说明 |
|---------|-------|------|
| 黄金 | 0.8-1.0 | 防御性资产 |
| 消费 | 0.9-1.1 | 稳定需求 |
| 有色金属 | 1.0-1.3 | 周期性强 |
| 医疗器械 | 0.9-1.2 | 中性偏稳 |
| 互联网 | 1.0-1.2 | 成长性 |
| 生物科技 | 1.2-1.5 | 高波动 |
| 半导体 | 1.0-1.3 | 周期+成长 |

### 第三项：结构性风险（10%权重）

#### 定义
脆弱度（Fragility），衡量公司特有的结构性风险，单位为百分点。

#### 脆弱度评估框架

**维度1：财务杠杆**
- 净负债率 < 30%：+0.5%
- 净负债率 30-60%：+1.0%
- 净负债率 60-100%：+2.0%
- 净负债率 > 100%：+3.0%

**维度2：客户集中度**
- 前五大客户占比 < 30%：+0.5%
- 前五大客户占比 30-50%：+1.0%
- 前五大客户占比 > 50%：+2.0%

**维度3：监管/政策风险**
- 低监管风险：+0.5%
- 中等监管风险：+1.0%
- 高监管风险（如互联网平台）：+2.0%

**维度4：技术/商业化风险**
- 成熟业务：+0.5%
- 商业化初期：+2.0%
- 研发阶段（如AI制药）：+4.0%

**维度5：再融资压力**
- 现金流充裕：+0.0%
- 需要定期融资：+1.0%
- 烧钱严重：+2.0%

#### 脆弱度评级标准

| 等级 | 范围 | 特征 | 示例 |
|------|------|------|------|
| 低脆弱 | 0.5-1.5% | 龙头、稳健、现金流好 | 紫金矿业、阿里巴巴 |
| 中等脆弱 | 1.5-3.0% | 一般公司、有一定风险 | 中国巨石、澜起科技 |
| 高脆弱 | 3.0-5.0% | 创新、烧钱、不确定性高 | 锦波生物、晶泰控股 |
| 极高脆弱 | 5.0%+ | 重大结构性风险 | 财务困境公司 |

#### 脆弱度示例

**低脆弱：紫金矿业（1.5%）**
- 财务：净负债率适中（+1.0%）
- 客户：分散，资源型企业（+0.5%）
- 监管：低风险（+0.0%）
- 业务：成熟（+0.0%）
- 融资：现金流充裕（+0.0%）
- **合计：1.5%**

**中等脆弱：澜起科技（2.5%）**
- 财务：低负债（+0.5%）
- 客户：集中度较高（+1.5%）
- 监管：低风险（+0.0%）
- 业务：半导体周期（+0.5%）
- 融资：无压力（+0.0%）
- **合计：2.5%**

**高脆弱：晶泰控股（5.0%）**
- 财务：烧钱（+2.0%）
- 客户：商业化初期（+1.0%）
- 监管：医药监管（+0.5%）
- 业务：AI制药研发风险（+1.5%）
- 融资：需要持续融资（+0.0%）
- **合计：5.0%**

### Scheme C完整示例

**案例：澜起科技**

**配置参数**：
```yaml
- name: "澜起科技"
  sector: "SEMI"
  expected_return: 0.35
  risk:
    mode: "SchemeC"
    beta: 1.15
    frag: 2.5
```

**行业数据（SEMI，2024-09-30至2025-09-30）**：
- σ_down = 0.2286 (22.86%)
- σ_total = 0.3924 (39.24%)

**Scheme C计算**：

**第一项：下行风险（60%）**
```
0.6 × 0.2286 = 0.13716 (13.716%)
```

**第二项：系统性风险（30%）**
```
0.3 × (1.15 × 0.3924) = 0.3 × 0.45126 = 0.135378 (13.538%)
```

**第三项：结构性风险（10%）**
```
0.1 × 0.025 = 0.0025 (0.25%)
```
- 注意：frag=2.5是百分点，需要除以100

**总损失风险**：
```
LossRisk = 0.13716 + 0.135378 + 0.0025
         = 0.275138
         ≈ 27.51%
```

**值博率**：
```
VTR = 0.35 / 0.2751 = 1.27
```

✅ 与系统输出完全一致

---

## 关键指标计算

### 总波动率（σ_total）

#### 定义
标准的收益率标准差，年化。

#### 计算公式
```
σ_total = std(returns) × sqrt(252)
```

#### 代码实现
```python
def total_volatility(returns, annualize=True, td_per_year=252):
    """
    计算总波动率

    参数：
    - returns: 日收益率序列
    - annualize: 是否年化
    - td_per_year: 每年交易日数

    返回：
    - 总波动率（年化）
    """
    std_daily = np.std(returns, ddof=1)  # 样本标准差

    if annualize:
        return std_daily * np.sqrt(td_per_year)
    else:
        return std_daily
```

### 最大回撤（MDD）

#### 定义
从峰值到谷底的最大下跌幅度。

#### 计算步骤

**步骤1：累计最高点**
```
cummax_t = max(P_1, P_2, ..., P_t)
```

**步骤2：回撤序列**
```
DD_t = (P_t / cummax_t) - 1
```
- DD_t ≤ 0（总是非正）
- DD_t = 0表示创新高

**步骤3：最大回撤**
```
MDD = min(DD_t) = |max(|DD_t|)|
```

#### 代码实现
```python
def maximum_drawdown(prices):
    """
    计算最大回撤

    参数：
    - prices: 价格序列（非收益率）

    返回：
    - 最大回撤（正值，如0.20表示20%）
    """
    # 1. 累计最高点
    cummax = prices.cummax()

    # 2. 回撤序列
    drawdown = (prices / cummax) - 1.0

    # 3. 最大回撤（取绝对值）
    mdd = drawdown.min()

    return abs(mdd)
```

#### 解读
- **< 10%**：低波动，如黄金ETF（11.64%）
- **10-20%**：中等波动，如有色金属（17.06%）
- **20-30%**：高波动，如医疗器械（23.96%）
- **> 30%**：极高波动，需警惕

**注意**：
- MDD在Scheme C中不直接使用
- 仅作为参考指标
- 在SemiMDD模式中占50%权重

---

## 期望收益框架

### 方式1：直接指定

**适用场景**：
- 已完成详细分析的标的
- 使用自己的估值模型
- 基于场景法（Bear/Base/Bull）

**配置示例**：
```yaml
- name: "阿里巴巴"
  sector: "INTERNET"
  expected_return: 0.40  # 40%
```

**优点**：
- 灵活，可以整合多种因素
- 适合复杂分析

**缺点**：
- 需要自行计算
- 无审计链路

### 方式2：估值模型

#### 支持的模型
1. **PE**：市盈率
2. **EV/EBITDA**：企业价值倍数
3. **EV/Sales**：市销率

#### 计算公式

**基础公式**：
```
ER_raw = (目标倍数/当前倍数 × (1+增长率) - 1) + 股息率 + 回购率
```

**分解**：

**倍数重定价**：
```
Rerating = 目标倍数 / 当前倍数 - 1
```
- 例如：PE从88降到45 → Rerating = 45/88 - 1 = -48.86%

**盈利增长**：
```
Growth = (1 + 增长率) - 1 = 增长率
```
- 例如：30%增长 → Growth = 0.30

**总收益**：
```
Total = (1 + Rerating) × (1 + Growth) - 1
```
- 例如：(-0.4886) × (1.30) - 1 = -0.3648 (-36.48%)

**加上股息和回购**：
```
ER_raw = Total + 股息率 + 回购率
```

**执行概率调整**：
```
ER = ER_raw × 执行概率
```

#### 配置示例

```yaml
- name: "澜起科技"
  sector: "SEMI"
  model:
    type: "PE"
    current_multiple: 88.0
    target_multiple: 45.0
    growth_12m: 0.30  # 30%盈利增长
    dividend_yield: 0.005  # 0.5%股息
    buyback_yield: 0.010  # 1%回购
    execution_prob: 0.90  # 90%执行概率
```

#### 计算示例

**步骤1：倍数重定价**
```
45 / 88 - 1 = -0.4886 (-48.86%)
```

**步骤2：加上增长**
```
(1 - 0.4886) × (1 + 0.30) - 1
= 0.5114 × 1.30 - 1
= 0.6648 - 1
= -0.3352 (-33.52%)
```

**步骤3：加上股息和回购**
```
-0.3352 + 0.005 + 0.010 = -0.3202 (-32.02%)
```

**步骤4：执行概率**
```
-0.3202 × 0.90 = -0.2882 (-28.82%)
```

**结论**：澜起科技期望收益为-28.82%（值博率为负）

### 方式3：场景法（v2.0框架）

#### 基本原理

基于"量×价×结构×成本→盈利增长×执行概率"的业务驱动分析。

**量（Quantity）**：
- 销量增长
- 市场份额变化
- 产能释放

**价（Price）**：
- 产品涨价
- 结构升级（高端化）
- ASP提升

**结构（Mix）**：
- 产品结构优化
- 客户结构改善
- 区域结构调整

**成本（Cost）**：
- 规模效应
- 原材料降本
- 运营效率

#### 场景设定

**Bear（悲观）**：
- 概率：20-30%
- 假设：需求下滑、价格承压、成本上升
- 期望收益：通常为负或接近0

**Base（中性）**：
- 概率：40-50%
- 假设：行业正常增长、公司执行到位
- 期望收益：基于合理假设

**Bull（乐观）**：
- 概率：20-30%
- 假设：需求超预期、份额提升、执行超预期
- 期望收益：高增长

#### 加权计算

```
ER = P_bear × ER_bear + P_base × ER_base + P_bull × ER_bull
```

**示例**：
```
Bear: 20% × (-10%) = -2%
Base: 50% × 30% = 15%
Bull: 30% × 60% = 18%
Total: -2% + 15% + 18% = 31%
```

#### v2.0框架示例

**高端化+涨价执行力强**：
- 建滔积层板：30%
- 澜起科技：35%
- 逻辑：高端产品放量 + 涨价传导顺畅

**结构提升+周期复苏**：
- 中国巨石：24%
- 生益科技：28%
- 晶泰控股：30%
- 逻辑：产品结构升级 + 行业景气度回升

**稳健增长**：
- 阿里巴巴：25%
- 金诚信：22%
- 长电科技：20%
- 逻辑：龙头地位稳固 + 市场份额提升

**温和增长**：
- 紫金矿业：18%
- 逻辑：资源价格温和 + 产能逐步释放

**承压/不确定性**：
- 中宠股份：15%
- 中材科技：15%
- 江西铜业：15%
- 锦波生物：12%
- 逻辑：需求承压或商业化不确定性

---

## 行业ETF代理

### 为什么选择ETF？

#### 优势
1. **稳定性**：包含多家公司，平滑个股特殊性
2. **代表性**：反映行业整体风险特征
3. **流动性**：主流ETF交易活跃，数据可靠
4. **可获得性**：公开数据，易于获取

#### 劣势
1. **成分差异**：ETF成分可能与标的公司业务不完全匹配
2. **权重差异**：ETF内部权重可能与行业平均不同
3. **跟踪误差**：ETF可能存在跟踪误差

### ETF选择标准

1. **行业相关性**：ETF主要成分与目标行业高度相关
2. **规模足够**：规模 > 10亿，确保流动性
3. **历史数据**：至少1年以上数据
4. **跟踪效果**：误差 < 2%

### 当前配置

| 行业代码 | ETF名称 | 代码 | 说明 |
|---------|--------|------|------|
| SEMI | 半导体50ETF | 512480.SS | 跟踪中证半导体50指数 |
| INTERNET | 中概互联网ETF | 513050.SS | 跟踪中概互联网50 |
| NONFER | 有色金属ETF | 512400.SS | 跟踪中证有色金属 |
| MEDDEV | 医疗器械ETF | 159898.SZ | 跟踪中证医疗器械 |
| BIOHK | 恒生生科ETF | 159892.SZ | 跟踪恒生生物科技 |
| CONSUMER | 消费ETF | 159928.SZ | 跟踪中证主要消费 |
| GOLD | 黄金ETF | 518850.SS | 跟踪上海金现货 |

### 混合行业暴露

对于业务跨多个行业的公司，使用加权平均。

**示例：紫金矿业**
```yaml
sector_mix:
  NONFER: 0.6  # 60%有色（铜、锌等）
  GOLD: 0.4    # 40%黄金
```

**风险指标混合**：
```
σ_down_混合 = 0.6 × σ_down_NONFER + 0.4 × σ_down_GOLD
           = 0.6 × 0.1978 + 0.4 × 0.1076
           = 0.1187 + 0.0430
           = 0.1617 (16.17%)

σ_total_混合 = 0.6 × 0.2767 + 0.4 × 0.1598
            = 0.1660 + 0.0639
            = 0.2299 (22.99%)
```

**结果**：
- 混合后风险低于纯有色（19.78%）
- 黄金的避险属性降低了整体风险

---

## 参数校准指南

### β系数校准

#### 方法1：历史回归（数据驱动）

如果有个股和行业ETF的历史数据：

```python
from volrisk.beta import beta_ols

# 获取个股和行业收益率
stock_returns = get_stock_returns("600547.SS", period="1y")
sector_returns = get_sector_returns("NONFER", period="1y")

# 回归计算β
beta = beta_ols(stock_returns, sector_returns)
print(f"历史回归β: {beta:.2f}")
```

**注意**：
- 至少需要6个月数据
- 检查R²，低于0.3时慎用
- 考虑窗口选择（6M/12M/24M）

#### 方法2：基本面判断（专家经验）

**周期性判断**：
- 强周期（有色、煤炭）：β = 1.2-1.5
- 弱周期（消费、医药）：β = 0.8-1.0

**杠杆判断**：
```
β_levered ≈ β_unlevered × (1 + (1-税率) × D/E)
```
- 高杠杆公司β更高
- 净负债率每增加50%，β约增加0.1-0.2

**市场地位**：
- 龙头：β偏低（0.9-1.0）
- 二线：β中性（1.0-1.1）
- 小公司：β偏高（1.1-1.3）

#### 方法3：可比公司法

参考同行业上市公司的β：

1. 找3-5家可比公司
2. 计算它们的β（如果有数据）
3. 取中位数或加权平均
4. 根据差异调整

#### 校准检查表

- [ ] β是否在合理范围（0.5-1.5）？
- [ ] 周期股β > 1.0？
- [ ] 防御股β < 1.0？
- [ ] 高杠杆公司β更高？
- [ ] 与同行业公司一致？

### 脆弱度校准

#### 评分表方法

| 维度 | 权重 | 低风险 | 中风险 | 高风险 |
|------|-----|--------|--------|--------|
| 财务杠杆 | 30% | 0.5% | 1.0% | 2.0% |
| 客户集中度 | 25% | 0.5% | 1.0% | 2.0% |
| 监管风险 | 20% | 0.5% | 1.0% | 2.0% |
| 技术风险 | 15% | 0.5% | 2.0% | 4.0% |
| 融资压力 | 10% | 0.0% | 1.0% | 2.0% |

**计算示例**：

某公司评分：
- 财务杠杆：中（1.0% × 30% = 0.30%）
- 客户集中度：高（2.0% × 25% = 0.50%）
- 监管风险：低（0.5% × 20% = 0.10%）
- 技术风险：中（2.0% × 15% = 0.30%）
- 融资压力：低（0.0% × 10% = 0.00%）

**总脆弱度**：0.30 + 0.50 + 0.10 + 0.30 + 0.00 = 1.20%

#### 校准检查表

- [ ] 脆弱度在合理范围（0.5-5.0%）？
- [ ] 高杠杆公司脆弱度更高？
- [ ] 烧钱公司脆弱度 > 3.0%？
- [ ] 龙头公司脆弱度 < 2.0%？
- [ ] 与行业平均比较合理？

---

## 模型验证

### 验证1：手工计算一致性

**目的**：验证代码实现是否正确

**方法**：
1. 选择1-2个标的
2. 手工计算每一步
3. 与程序输出对比

**示例**：详见`docs/CALCULATION_COMPARISON.md`

**结果**：13家公司中12家完全一致（< 0.03%差异）

### 验证2：排名稳定性

**目的**：验证排名是否稳健

**方法**：
1. 调整时间窗口（6M vs 12M）
2. 观察排名变化
3. Top 3应基本稳定

**示例**：
```bash
# 6个月
python3 -m volrisk.cli rank --period 6mo --output results_6m.xlsx

# 12个月
python3 -m volrisk.cli rank --period 12mo --output results_12m.xlsx

# 对比排名
```

### 验证3：参数敏感性

**目的**：了解参数变化的影响

**方法**：
1. β ± 0.1，观察值博率变化
2. Frag ± 1%，观察值博率变化
3. 变化应在合理范围（< 10%）

**示例**：
```yaml
# 基准
beta: 1.15
frag: 2.5
# 值博率: 1.27

# 测试1: β+0.1
beta: 1.25
frag: 2.5
# 值博率: ? (预期略降)

# 测试2: Frag+1%
beta: 1.15
frag: 3.5
# 值博率: ? (预期略降)
```

### 验证4：行业风险合理性

**目的**：验证行业风险是否符合直觉

**检查**：
- [ ] 黄金风险最低？（σ_down < 12%）
- [ ] 半导体风险最高？（σ_down > 20%）
- [ ] 消费风险中等？（σ_down 15-20%）
- [ ] MDD与σ_down正相关？

**当前数据（2024-09-30至2025-09-30）**：
```
黄金：σ_down=10.76% ✅ 最低
消费：σ_down=15.93% ✅ 中低
有色：σ_down=19.78% ✅ 中等
半导体：σ_down=22.86% ✅ 最高
```

符合预期！

---

## 附录

### A. 术语表

- **值博率（VTR）**：Value-to-Risk Ratio，期望收益与损失风险的比值
- **下行波动率（σ_down）**：Downside Volatility，基于半方差的风险度量
- **总波动率（σ_total）**：Total Volatility，标准差
- **最大回撤（MDD）**：Maximum Drawdown，从峰值到谷底的最大跌幅
- **β系数（Beta）**：个股相对行业的敏感度
- **脆弱度（Fragility）**：结构性风险加点
- **MAR**：Minimum Acceptable Return，最低可接受收益（默认0）
- **半方差（Semi-Variance）**：只考虑负收益的方差

### B. 公式汇总

**下行波动率**：
```
σ_down = sqrt(mean(min(r - MAR, 0)²)) × sqrt(252)
```

**总波动率**：
```
σ_total = std(r) × sqrt(252)
```

**最大回撤**：
```
MDD = max(1 - P_t / max(P_s, s≤t))
```

**β系数**：
```
β = Cov(stock, sector) / Var(sector)
```

**Scheme C风险**：
```
LossRisk = 0.6×σ_down + 0.3×(β×σ_total) + 0.1×Frag
```

**值博率**：
```
VTR = ER / LossRisk
```

### C. 参考文献

1. Markowitz, H. (1952). "Portfolio Selection", *Journal of Finance*
2. Sortino, F. A., & Price, L. N. (1994). "Performance Measurement in a Downside Risk Framework", *Journal of Investing*
3. Bernstein, P. L. (1996). *Against the Gods: The Remarkable Story of Risk*
4. Estrada, J. (2002). "Systematic Risk in Emerging Markets: the D-CAPM", *Emerging Markets Review*

---

**最后更新**: 2025-10-05
**版本**: v1.0.0
**维护者**: @LpcPaul
